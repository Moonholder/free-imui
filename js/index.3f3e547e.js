(function(t){function e(e){for(var n,i,o=e[0],d=e[1],s=e[2],u=0,l=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&l.push(r[i][0]),r[i]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(t[n]=d[n]);f&&f(e);while(l.length)l.shift()();return c.push.apply(c,s||[]),a()}function a(){for(var t,e=0;e<c.length;e++){for(var a=c[e],n=!0,o=1;o<a.length;o++){var d=a[o];0!==r[d]&&(n=!1)}n&&(c.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},r={index:0},c=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=e,o=o.slice();for(var s=0;s<o.length;s++)e(o[s]);var f=d;c.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("a429")},"1e0a":function(t,e,a){"use strict";a("3509")},"2dd8":function(t,e,a){},"2e03":function(t,e,a){},"31a0":function(t,e,a){},"327d":function(t,e,a){},"34aa":function(t,e,a){},3509:function(t,e,a){},"72cb":function(t,e,a){},"7c7f":function(t,e,a){},"9c5a":function(t,e,a){},"9faf":function(t,e,a){},a429:function(t,e,a){"use strict";a.r(e);var n=a("7a23"),r=[{id:"1",nickname:"猪小明",avatar:"猪小明",sort:"Z",lastMessage:"今天几点下班？哈哈哈哈哈哈哈",lastMessageTime:1656668389920,lastMessageStatus:"success",unread:100},{id:2,nickname:"茅台",avatar:"茅台",sort:"M",lastMessage:"晚一点",lastMessageTime:1655114917370,lastMessageStatus:"success",unread:0},{id:3,nickname:"冷檬",avatar:"冷檬",sort:"L",lastMessage:"今晚一起看电影吗",lastMessageTime:1655114917370,lastMessageStatus:"success",unread:0},{id:8,nickname:"米线",avatar:"米线",sort:"M",lastMessage:"文件已经发给你了",lastMessageTime:1655114917370,lastMessageStatus:"success",unread:2},{id:66,nickname:"陈翔六点半",avatar:"群聊",sort:"",lastMessage:"文件已经发给你了",lastMessageTime:1655114917370,lastMessageStatus:"success",unread:2,group:!0},{id:4,nickname:"我的名字很长很长很长很长",avatar:"很长",sort:"H",lastMessage:"我的内容很长很长很长很长",lastMessageStatus:"success",lastMessageTime:1655114917370,unread:6},{id:5,nickname:"张三",avatar:"张三",sort:"Z",lastMessage:"",lastMessageTime:1655114917370,lastMessageStatus:"success",unread:0}],c=["您好，几点下班","九点半","提醒您衣物洗护好了","好的，周一取","好的，周一取","我是您的专属服务管家, 随时为您服务~","好的","周六可以看","价格我去帮您谈","价格还能谈"],i=function(t){for(var e=[],a=t;a<t+10;a++)e.push({id:a,time:(new Date).getTime(),type:"text",status:"success",content:c[a]?c[a]:a+"",toContactId:a%2===0?"66":a,from:{id:a%2===0?"66":a,nickname:a%2===0?"陈翔":"茅台",avatar:a%2===0?"陈翔":"茅台"}});return e.push({type:"event",time:(new Date).getTime(),id:1e3,status:"success",content:"",toContactId:"",from:{id:"66",nickname:"陈翔",avatar:"陈翔"}}),e},o=function(t){return Object(n["s"])("data-v-11e703f7"),t=t(),Object(n["r"])(),t},d={class:"free-doc"},s=o((function(){return Object(n["e"])("div",{style:{"background-color":"#FFF"}},[Object(n["e"])("input",{type:"text",style:{}})],-1)})),f={class:"free-doc-buttons"},u=Object(n["h"])("发送一条消息"),l=Object(n["h"])("修改消息"),v=Object(n["h"])("消息列表头部插槽"),m=Object(n["h"])("显示隐藏聊天窗口内名字"),p=Object(n["h"])("切换头像形状"),b=Object(n["h"])("修改联系人信息"),g=Object(n["h"])("切换左侧菜单头像显示"),h=Object(n["h"])("切换左侧菜单展示"),j=Object(n["g"])('<h2 class="free-doc-title" data-v-11e703f7>API</h2><h2 class="free-doc-title" data-v-11e703f7>用户信息 User</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>参数</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>类型</th><th data-v-11e703f7>默认值</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>id</td><td data-v-11e703f7>联系人ID</td><td data-v-11e703f7>string | number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>nickname</td><td data-v-11e703f7>联系人名称</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>avatar</td><td data-v-11e703f7>头像</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>联系人 Contact</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>参数</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>类型</th><th data-v-11e703f7>默认值</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>id</td><td data-v-11e703f7>联系人ID</td><td data-v-11e703f7>string | number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>nickname</td><td data-v-11e703f7>名称</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>avatar</td><td data-v-11e703f7>头像</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>sort</td><td data-v-11e703f7>排序索引</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>lastMessage</td><td data-v-11e703f7>最近一条消息</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>lastMessageStatus</td><td data-v-11e703f7>最近一条消息状态</td><td data-v-11e703f7>&#39;success&#39; | &#39;error&#39; | &#39;uploading&#39;</td><td data-v-11e703f7>&#39;success&#39;</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>lastMessageTime</td><td data-v-11e703f7>最近一条消息时间戳</td><td data-v-11e703f7>number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>unread</td><td data-v-11e703f7>未读消息</td><td data-v-11e703f7>number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>group</td><td data-v-11e703f7>是否为群组</td><td data-v-11e703f7>boolean</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>消息 Message</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>参数</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>类型</th><th data-v-11e703f7>默认值</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>id</td><td data-v-11e703f7>消息ID</td><td data-v-11e703f7>string | number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>time</td><td data-v-11e703f7>消息发送时间</td><td data-v-11e703f7>number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>type</td><td data-v-11e703f7>消息类型</td><td data-v-11e703f7>&#39;text&#39; | &#39;image&#39; | &#39;file&#39;</td><td data-v-11e703f7>&#39;text&#39;</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>status</td><td data-v-11e703f7>消息状态</td><td data-v-11e703f7>&#39;success&#39; | &#39;error&#39; | &#39;uploading&#39;</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>content</td><td data-v-11e703f7>消息内容</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>toContactId</td><td data-v-11e703f7>接受消息的联系人ID</td><td data-v-11e703f7>string | number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>fileName</td><td data-v-11e703f7>文件名称</td><td data-v-11e703f7>string</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>fileSize</td><td data-v-11e703f7>文件大小</td><td data-v-11e703f7>number</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>fromUser</td><td data-v-11e703f7>发送消息者信息</td><td data-v-11e703f7><a href="" data-v-11e703f7>object</a></td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>属性</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>参数</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>类型</th><th data-v-11e703f7>默认值</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>width</td><td data-v-11e703f7>宽度</td><td data-v-11e703f7>string | number</td><td data-v-11e703f7>860</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>height</td><td data-v-11e703f7>高度</td><td data-v-11e703f7>string | number</td><td data-v-11e703f7>580</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>shape</td><td data-v-11e703f7>指定头像形状</td><td data-v-11e703f7>circle | square</td><td data-v-11e703f7>square</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>message-name</td><td data-v-11e703f7>是否显示聊天窗口内的联系人名称</td><td data-v-11e703f7>boolean</td><td data-v-11e703f7>false</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>menu-avatar</td><td data-v-11e703f7>是否显示左侧菜单头像</td><td data-v-11e703f7>boolean</td><td data-v-11e703f7>true</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>show-menu</td><td data-v-11e703f7>是否展示左侧菜单</td><td data-v-11e703f7>boolean</td><td data-v-11e703f7>true</td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>事件</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>事件名称</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>回调参数</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>change-menu</td><td data-v-11e703f7>切换左侧选项卡时触发</td><td data-v-11e703f7>(menuName: string): void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>change-contact</td><td data-v-11e703f7>切换近期联系人时触发</td><td data-v-11e703f7>(currentContact: Contact): void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>change-contact-message</td><td data-v-11e703f7>切换联系人消息时触发</td><td data-v-11e703f7>(currentContact: Contact): void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>pull-messages</td><td data-v-11e703f7>聊天窗口滚动到顶部时或首次打开该联系人窗口时触发。调用 next 方法结束 loading 状态，设置 end 为 true 将不在触发该事件</td><td data-v-11e703f7>(contact: Contact, next: PullMessageNext) =&gt; void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>message-click</td><td data-v-11e703f7>消息点击事件</td><td data-v-11e703f7>(e: Event, key: string, messgae: Message, instance: FreeInstance) =&gt; void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>send</td><td data-v-11e703f7>发送消息时触发</td><td data-v-11e703f7> (contact: Contact, message: Message, next: SendNext, file: File) =&gt; void </td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>组件方法</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>方法名称</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>类型</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>useMenus</td><td data-v-11e703f7>初始化导航</td><td data-v-11e703f7>(menus: Menu[]) =&gt; void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>initContacts</td><td data-v-11e703f7>初始化联系人</td><td data-v-11e703f7>(contacts: Contact[]) =&gt; void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>appendMessage</td><td data-v-11e703f7>添加一条消息</td><td data-v-11e703f7>(message: Message) =&gt; void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>updateContact</td><td data-v-11e703f7>修改联系人信息, 根据 ContactId 修改</td><td data-v-11e703f7>(contact: ContactUpdate) =&gt; void</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>getCurrentMessages</td><td data-v-11e703f7>获取当前聊天窗口消息</td><td data-v-11e703f7>ComputedRef&lt;Message[]&gt;</td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>scrollToBottom</td><td data-v-11e703f7>将聊天窗口滚动到最底部</td><td data-v-11e703f7>() =&gt; void</td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>插槽</h2><table data-v-11e703f7><thead data-v-11e703f7><tr data-v-11e703f7><th data-v-11e703f7>名称</th><th data-v-11e703f7>说明</th><th data-v-11e703f7>类型</th><th data-v-11e703f7>版本</th></tr></thead><tbody data-v-11e703f7><tr data-v-11e703f7><td data-v-11e703f7>messages-fixed-top</td><td data-v-11e703f7>近期联系人头部固定插槽</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr><tr data-v-11e703f7><td data-v-11e703f7>contact-detail</td><td data-v-11e703f7>联系人详情插槽</td><td data-v-11e703f7></td><td data-v-11e703f7></td></tr></tbody></table><h2 class="free-doc-title" data-v-11e703f7>类型定义</h2><div class="free-doc-code" data-v-11e703f7> import type { FreeInstance, Contact, PullMessageNext } from &#39;free-im&#39;; </div>',17),O=Object(n["j"])({__name:"App",setup:function(t){var e=Object(n["u"])(),a={id:"66",nickname:"陈翔",avatar:"陈翔"};Object(n["p"])((function(){var t;null===(t=e.value)||void 0===t||t.initContacts(r)}));var c=0,o=function(t,e,a){2===t.id?setTimeout((function(){c<20?(e(i(c)),c+=10):e([],!0)}),5e3):setTimeout((function(){e([],!0)}),2e3)},O=function(t,e,a){setTimeout((function(){a(e,t,"error")}),3e3)},y=Object(n["u"])(!1),x=function(){y.value=!y.value},w=function(){var t;null===(t=e.value)||void 0===t||t.appendMessage({id:"66",time:(new Date).getTime(),type:"text",status:"success",content:"我发了一条消息给你",toContactId:3,from:{id:3,nickname:"冷檬",avatar:"冷檬"}})},M=Object(n["u"])(!1),k=function(){M.value=!M.value},_=function(t,a,n,r){var c;(console.log(a),"status"===a)&&(null===(c=e.value)||void 0===c||c.updateMessage({id:n.id,status:"uploading",content:"正在重新发送...",toContactId:n.toContactId}),setTimeout((function(){var t;null===(t=e.value)||void 0===t||t.updateMessage({id:n.id,status:"success",content:n.content,toContactId:n.toContactId})}),2e3))},C=Object(n["u"])("square"),I=function(){"square"===C.value?C.value="circle":C.value="square",console.log(C.value)},T=Object(n["u"])("猪小明"),S=function(){var t;T.value+=1,null===(t=e.value)||void 0===t||t.updateContact({id:"1",nickname:T.value,unread:6,lastMessage:"修改了联系人信息"})},E=Object(n["u"])(!0),L=function(){E.value=!E.value},z=function(){var t,a=(null===(t=e.value)||void 0===t?void 0:t.getCurrentMessages.value)||[];if(console.log(a),a.length>0){var n,r,c=a[a.length-1];null===(n=e.value)||void 0===n||n.updateMessage({id:c.id,toContactId:c.toContactId,type:"file",fileName:"这条消息被修改了",fileSize:8e3}),null===(r=e.value)||void 0===r||r.scrollToBottom()}},P=Object(n["u"])(!0),D=function(){P.value=!P.value};return function(t,r){var c=Object(n["v"])("free-im"),i=Object(n["v"])("free-button");return Object(n["q"])(),Object(n["d"])("div",d,[Object(n["i"])(c,{ref_key:"freeIM",ref:e,onPullMessages:o,onMessageClick:_,onSend:O,shape:C.value,"show-menu":P.value,"user-info":a,"menu-avatar":E.value,"message-name":M.value},Object(n["f"])({_:2},[y.value?{name:"messages-fixed-top",fn:Object(n["y"])((function(){return[s]}))}:void 0]),1032,["shape","show-menu","menu-avatar","message-name"]),Object(n["e"])("div",f,[Object(n["i"])(i,{onClick:w},{default:Object(n["y"])((function(){return[u]})),_:1}),Object(n["i"])(i,{onClick:z},{default:Object(n["y"])((function(){return[l]})),_:1}),Object(n["i"])(i,{onClick:x},{default:Object(n["y"])((function(){return[v]})),_:1}),Object(n["i"])(i,{onClick:k},{default:Object(n["y"])((function(){return[m]})),_:1}),Object(n["i"])(i,{onClick:I},{default:Object(n["y"])((function(){return[p]})),_:1}),Object(n["i"])(i,{onClick:S},{default:Object(n["y"])((function(){return[b]})),_:1}),Object(n["i"])(i,{onClick:L},{default:Object(n["y"])((function(){return[g]})),_:1}),Object(n["i"])(i,{onClick:D},{default:Object(n["y"])((function(){return[h]})),_:1})]),j])}}}),y=(a("1e0a"),a("6b0d")),x=a.n(y);const w=x()(O,[["__scopeId","data-v-11e703f7"]]);var M=w,k=[Number,String],_=function(t){return{type:k,default:t}},C=function(t){return{type:[Number],default:t}},I=function(t){return{type:[String],default:t}},T=function(t){return{type:[Boolean],default:t}},S=function(){return{type:Object,required:!0}},E=function(){return{type:Array,default:function(){return[]}}},L=Array.isArray,z=function(t){return"string"===typeof t},P=function(t){return"function"===typeof t},D=Object.assign,N=function(t){return t.replace(/-(\w)/g,(function(t,e){return e.toUpperCase()}))};function A(t){return t.install=function(e){var a=t.name;e.component(a,t),e.component(N("-".concat(a)),t)},t}var F=function(t){var e=new Date(t),a=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return a+"/"+n+"/"+r},B=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,a="x"==t?e:3&e|8;return a.toString(16)}))};function U(t){if(!t)return"0 Bytes";var e=["B","K","M","G","T","P","E","Z","Y"],a=0;a=Math.floor(Math.log(t)/Math.log(1024));var n=t/Math.pow(1024,a);return n=parseFloat(n.toFixed(2)),n+e[a]}function q(t){var e,a=new Date(t),n=new Date,r=function(t){return t.getFullYear()},c=function(t){return"".concat(t.getMonth()+1,"-").concat(t.getDay())},i=r(a),o=r(n);return e=i!==o?"Y年M月D日 h:m":"".concat(i,"-").concat(c(a))==="".concat(o,"-").concat(c(n))?"h:m":"M月D日 h:m",G(t,e)}function G(t,e){e||(e="Y-M-D h:m:s"),t=t?new Date(t):new Date;for(var a=[t.getFullYear().toString(),Y(t.getMonth()+1),Y(t.getDate()),Y(t.getHours()),Y(t.getMinutes()),Y(t.getSeconds())],n="YMDhms",r=0;r<a.length;r++)e=e.replace(n.charAt(r),a[r]);return e}function Y(t){return t<10?"0".concat(t):t.toString()}var R=[{key:"messages",title:"消息",unread:0,click:null,bottom:!1,render:function(){return Object(n["i"])("i",{class:"free-icon-messages"},null)}},{key:"contacts",title:"联系人",unread:0,click:null,bottom:!1,render:function(){return Object(n["i"])("i",{class:"free-icon-contacts"},null)}},{key:"settings",title:"联系人",unread:0,click:null,bottom:!0,render:function(){return Object(n["i"])("i",{class:"free-icon-menu"},null)}}],H={messages:0,contacts:1};function K(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=Object(n["u"])([]);return Array.isArray(t)?e.value=t.map((function(t){return Object.keys(H).includes(t.key)?R[H[t.key]]:t})):e.value=R,e}function Z(t){var e=Object(n["k"])();e&&D(e.proxy,t)}function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function $(t){return X(t)||W(t)||Q(t)||V()}function V(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Q(t,e){if(t){if("string"===typeof t)return tt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?tt(t,e):void 0}}function W(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function X(t){if(Array.isArray(t))return tt(t)}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function et(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function at(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?et(Object(a),!0).forEach((function(e){nt(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):et(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function nt(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function rt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */rt=function(){return t};var t={},e=Object.prototype,a=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",c=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function o(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(_){o=function(t,e,a){return t[e]=a}}function d(t,e,a,n){var r=e&&e.prototype instanceof u?e:u,c=Object.create(r.prototype),i=new w(n||[]);return c._invoke=function(t,e,a){var n="suspendedStart";return function(r,c){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw c;return k()}for(a.method=r,a.arg=c;;){var i=a.delegate;if(i){var o=O(i,a);if(o){if(o===f)continue;return o}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var d=s(t,e,a);if("normal"===d.type){if(n=a.done?"completed":"suspendedYield",d.arg===f)continue;return{value:d.arg,done:a.done}}"throw"===d.type&&(n="completed",a.method="throw",a.arg=d.arg)}}}(t,a,i),c}function s(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(_){return{type:"throw",arg:_}}}t.wrap=d;var f={};function u(){}function l(){}function v(){}var m={};o(m,r,(function(){return this}));var p=Object.getPrototypeOf,b=p&&p(p(M([])));b&&b!==e&&a.call(b,r)&&(m=b);var g=v.prototype=u.prototype=Object.create(m);function h(t){["next","throw","return"].forEach((function(e){o(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function n(r,c,i,o){var d=s(t[r],t,c);if("throw"!==d.type){var f=d.arg,u=f.value;return u&&"object"==J(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,o)}),(function(t){n("throw",t,i,o)})):e.resolve(u).then((function(t){f.value=t,i(f)}),(function(t){return n("throw",t,i,o)}))}o(d.arg)}var r;this._invoke=function(t,a){function c(){return new e((function(e,r){n(t,a,e,r)}))}return r=r?r.then(c,c):c()}}function O(t,e){var a=t.iterator[e.method];if(void 0===a){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(a,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,f;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function y(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(y,this),this.reset(!0)}function M(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,c=function e(){for(;++n<t.length;)if(a.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return c.next=c}}return{next:k}}function k(){return{value:void 0,done:!0}}return l.prototype=v,o(g,"constructor",v),o(v,"constructor",l),l.displayName=o(v,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,o(t,i,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},h(j.prototype),o(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,a,n,r,c){void 0===c&&(c=Promise);var i=new j(d(e,a,n,r),c);return t.isGeneratorFunction(a)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},h(g),o(g,i,"Generator"),o(g,r,(function(){return this})),o(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){for(;e.length;){var n=e.pop();if(n in t)return a.value=n,a.done=!1,a}return a.done=!0,a}},t.values=M,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(a,n){return i.type="throw",i.arg=t,e.next=a,n&&(e.method="next",e.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r],i=c.completion;if("root"===c.tryLoc)return n("end");if(c.tryLoc<=this.prev){var o=a.call(c,"catchLoc"),d=a.call(c,"finallyLoc");if(o&&d){if(this.prev<c.catchLoc)return n(c.catchLoc,!0);if(this.prev<c.finallyLoc)return n(c.finallyLoc)}else if(o){if(this.prev<c.catchLoc)return n(c.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return n(c.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var c=r;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=e&&e<=c.finallyLoc&&(c=null);var i=c?c.completion:{};return i.type=t,i.arg=e,c?(this.method="next",this.next=c.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),x(a),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var n=a.completion;if("throw"===n.type){var r=n.arg;x(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:M(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=void 0),f}},t}function ct(t,e,a,n,r,c,i){try{var o=t[c](i),d=o.value}catch(s){return void a(s)}o.done?e(d):Promise.resolve(d).then(n,r)}function it(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function i(t){ct(c,n,r,i,o,"next",t)}function o(t){ct(c,n,r,i,o,"throw",t)}i(void 0)}))}}function ot(t){return"function"===typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!Object(n["m"])(t)}var dt={width:_(860),height:_(580),shape:I("square"),showMenu:T(!0),userInfo:S(),messageName:T(!1),menuAvatar:T(!0)},st=Object(n["j"])({name:"free-im",props:dt,provide:function(){return{userInfo:this.userInfo,freeIM:this}},setup:function(t,e){var a=e.slots,r=e.emit,c=t.width,i=t.height,o={width:c+"px",height:i+"px"},d=Object(n["u"])("messages"),s=Object(n["u"])([]),f=Object(n["u"])([]),u=Object(n["u"])(),l=Object(n["u"])(),v=Object(n["t"])(new Map),m=Object(n["t"])(new Map),p=Object(n["t"])(new Map),b=Object(n["t"])(new Map),g=K(),h=Object(n["u"])(null),j=Object(n["b"])((function(){return s.value.find((function(t){return t.id===l.value}))})),O=Object(n["b"])((function(){return l.value&&v.get(l.value)||[]})),y=Object(n["b"])((function(){var t=s.value.filter((function(t){return t.lastMessage}));return t.sort((function(t,e){return(e.lastMessageTime?e.lastMessageTime:0)-(t.lastMessageTime?t.lastMessageTime:0)})),t})),x=Object(n["b"])((function(){var t=0;return y.value.forEach((function(e){t+=e.unread})),t}));function w(){var t=[],e=[];function a(t){t.bottom||C(t.key)}return g.value.forEach((function(r){var c,i=Object(n["i"])("div",{class:"free-menu-item ".concat(d.value===r.key?"free-menu-active":""),title:r.title,onClick:function(){P(r.click)?r.click:a(r)}},["messages"===r.key?Object(n["i"])(Object(n["v"])("free-badge"),{unread:x.value},ot(c=r.render())?c:{default:function(){return[c]}}):r.render()]);r.bottom?e.push(i):t.push(i)})),{top:t,bottom:e}}function M(){return Object(n["i"])("div",{class:"free-menu"},[Object(n["i"])("div",{class:"free-menu-top"},[Object(n["z"])(Object(n["i"])(Object(n["v"])("free-avatar"),{class:"free-menu-avatar",avatar:t.userInfo.avatar},null),[[n["x"],t.menuAvatar]]),w().top]),Object(n["i"])("div",{class:"free-menu-bottom"},[w().bottom])])}function k(){return Object(n["i"])(n["a"],null,[Object(n["z"])(Object(n["i"])("div",{class:"free-sidebar free-sidebar-messages"},[Object(n["i"])("div",{class:"free-messages-fiexd_top"},[a["messages-fixed-top"]?a["messages-fixed-top"]():""]),S()]),[[n["x"],"messages"===d.value]]),Object(n["z"])(Object(n["i"])("div",{class:"free-sidebar free-sidebar-messages"},[A()]),[[n["x"],"contacts"===d.value]])])}function _(t){t.forEach((function(t){t.group?f.value.push(t):s.value.push(t)})),F()}function C(t){r("change-menu",t),d.value=t}function I(t,e){if(e)C(e);else if(t===l.value)return;l.value=t,r("change-contact",j.value),v.has(t)?p.set(t,!1):D((function(){h.value&&h.value.scrollToBottom()}))}function T(){h.value&&h.value.scrollToBottom()}function S(){var t=function(t){var e;(E(t),l.value=t.id,v.has(t.id))?(p.set(t.id,!1),null===(e=h.value)||void 0===e||e.scrollToBottom()):D((function(){h.value&&h.value.scrollToBottom()}));r("change-contact-message",j.value)};return y.value.map((function(e){return Object(n["i"])(Object(n["v"])("free-contact"),Object(n["n"])(N(e.id,l.value),{onClick:function(){t(e)},contact:e,"is-message":!0}),null)}))}function E(t){var e=V(t.id);s.value[e].unread=0}function D(t){var e,a=j.value;if(v.has(a.id)||v.set(a.id,[]),!b.has(a.id)){var n=v.has(a.id)?null===(e=v.get(a.id))||void 0===e?void 0:e.length:0;p.set(a.id,!0),b.set(a.id,!0),r("pull-messages",a,function(){var e=it(rt().mark((function e(n,r){return rt().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.length,W(n,a.id,"unshift"),m.set(a.id,r),p.set(a.id,!1),b.delete(a.id),t&&t(!!r);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n)}}var N=function(t,e){return{class:e===t?"free-contact-active":""}};function A(){var t=function(t){u.value=t},e="",a=s.value.map((function(a){var r,c=[a.sort!==e?Object(n["i"])("div",{class:"free-index"},[a.sort]):"",Object(n["i"])(Object(n["v"])("free-contact"),Object(n["n"])(N(a.id,null===(r=u.value)||void 0===r?void 0:r.id),{onClick:t,contact:a,base:!0}),null)];return e=a.sort,c}));return[Object(n["i"])("div",{class:"free-contact-category-label"},[Object(n["h"])("群聊")]),f.value.map((function(e){return Object(n["i"])(Object(n["v"])("free-contact"),Object(n["n"])(N(e.id),{onClick:t,contact:e,base:!0}),null)})),Object(n["i"])("div",{class:"free-contact-category-label"},[Object(n["h"])("联系人")]),a]}function F(){s.value.sort((function(t,e){return t.group,t.sort.localeCompare(e.sort)}))}var U=Object(n["b"])((function(){return!!m.has(l.value)&&m.get(l.value)})),q=Object(n["b"])((function(){return!p.has(l.value)||p.get(l.value)})),G=function(t){return"file"===t.type?"[文件]":"image"===t.type?"[图片]":t.content},Y=function(t){console.log(t);var e=X({content:t});Q(e),j.value&&R(j.value,e,(function(t){J({id:t.id,lastMessageTime:e.time,lastMessage:G(e),lastMessageStatus:e.status,unread:0})}))};function R(t,e,a,n){r("send",t,e,(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"success";a(e),H(Object.assign(t,{status:n}))}),n)}function H(t){if(v.has(t.toContactId)){var e,a=null===(e=v.get(t.toContactId))||void 0===e?void 0:e.findIndex((function(e){return e.id===t.id}));if(-1!==a){var n=v.get(t.toContactId)[a];v.get(t.toContactId)[a]=at(at(at({},n),t),{},{toContactId:n.toContactId})}}}function J(t){var e=t.id;delete t.id;var a=V(e);if(-1!==a){var n=t.unread;z(n)&&(0===n.indexOf("+")||0===n.indexOf("-")?t.unread=parseInt(n)+s.value[a].unread:0===n.length?t.unread=0:t.unread=parseInt(t.unread)),s.value[a]=at(at({},s.value[a]),t)}}function V(t){return t?s.value.findIndex((function(e){return e.id===t})):-1}function Q(t){if(console.log(t),v.has(t.toContactId)){W(t,t.toContactId,"push");var e,a={id:t.toContactId,lastMessageTime:t.time,lastMessage:G(t),lastMessageStatus:t.status,unread:""};if(t.toContactId===l.value)null===(e=h.value)||void 0===e||e.scrollToBottom();else a.unread="+1";J(a)}else J({id:t.toContactId,unread:"+1",lastMessageTime:t.time,lastMessage:G(t)})}function W(t,e,a){var n;L(t)||(t=[t]),v.set(e,v.get(e)||[]),(n=v.get(e))[a].apply(n,$(t))}function X(e){return at(at({},{id:B(),time:(new Date).getTime(),type:"text",status:"uploading",toContactId:l.value,from:t.userInfo}),e)}var tt=function(t){var e,a=["image/png","image/jpeg","image/gif"];if(a.includes(t.type)){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){e={content:n.result,type:"image"},et(e,t)}}else e={type:"file",fileSize:t.size,fileName:t.name,content:""},et(e,t)};function et(t,e){var a=X(t);Q(a),j.value&&R(j.value,a,(function(t){}),e)}function nt(){var e=function(){var t,e,a;null!==(t=u.value)&&void 0!==t&&t.lastMessage||J({id:null===(a=u.value)||void 0===a?void 0:a.id,lastMessage:" "});I(null===(e=u.value)||void 0===e?void 0:e.id,"messages")},r=function(){var r,c;return"contacts"===d.value&&u.value?a["contact-detail"]?a["contact-detail"]({contact:u.value}):Object(n["i"])("div",{class:"free-contact-main"},[Object(n["i"])("div",{class:"free-contact-detail_header"},[Object(n["i"])(Object(n["v"])("free-avatar"),{avatar:null===(r=u.value)||void 0===r?void 0:r.avatar},null),Object(n["i"])("div",{class:"free-contact-nickname"},[null===(c=u.value)||void 0===c?void 0:c.nickname])]),Object(n["i"])("div",{class:"free-contact-detail_body"},null),Object(n["i"])("div",{class:"free-contact-detail_footer"},[Object(n["i"])(Object(n["v"])("free-button"),{type:"primary",onClick:e},{default:function(){return[Object(n["h"])("发送")]}})])]):"messages"===d.value&&j.value?Object(n["i"])("div",{class:"free-contact-main"},[Object(n["i"])("div",{class:"free-contact-messages_header"},[Object(n["i"])("span",null,[j.value.nickname]),Object(n["i"])("i",{class:"free-icon-more"},null)]),Object(n["i"])("div",{class:"free-contact-messages_body"},[Object(n["i"])(Object(n["v"])("free-messages"),{ref:h,onLoad:D,messageName:t.messageName,data:v.get(j.value.id),"is-end":U.value,loading:q.value},null),Object(n["i"])(Object(n["v"])("free-editor"),{contact:j.value,onSend:Y,onUpload:tt},null)])]):void 0};return Object(n["i"])("div",{class:"free-content"},[r()])}return Z({useMenus:K,initContacts:_,appendMessage:Q,updateMessage:H,updateContact:J,getCurrentMessages:O,scrollToBottom:T}),function(){return Object(n["i"])("div",{class:"free-wrapper free-theme-default",style:o},[t.showMenu&&M(),k(),nt()])}}}),ft=(a("a9a5"),A(st)),ut={avatar:I("头像"),size:C(40)},lt=Object(n["j"])({props:ut,name:"free-avatar",inject:["freeIM"],setup:function(t){var e=Object(n["l"])("freeIM"),a=Object(n["b"])((function(){return e?e.shape:"square"}));return function(){return Object(n["i"])("div",{class:"free-avatar free-avatar-".concat(a.value),style:"width: ".concat(t.size,"px;height: ").concat(t.size,"px;line-height: ").concat(t.size,"px;")},[t.avatar?t.avatar.substr(-2):t.avatar])}}});a("9c5a");lt.install=function(t){t.component(lt.name,lt)};var vt=lt,mt={type:I("default"),size:I("default")},pt=Object(n["j"])({name:"free-button",props:mt,setup:function(t,e){var a=e.slots,r=t.type;return function(){return Object(n["i"])("button",{class:"free-button free-button-".concat(r," free-button-size__").concat(t.size)},[a.default?a.default():""])}}});a("34aa");pt.install=function(t){t.component(pt.name,pt)};var bt=pt,gt={contact:S(),isMessage:T(!1),base:T(!1)},ht=Object(n["j"])({name:"free-contact",props:gt,emits:["click"],setup:function(t,e){var a=e.emit,r=function(){a("click",t.contact)};return function(){return Object(n["i"])("div",{class:"free-contact",onClick:r},[t.base,Object(n["i"])(Object(n["v"])("free-badge"),{unread:t.base?void 0:t.contact.unread},{default:function(){return[Object(n["i"])(Object(n["v"])("free-avatar"),{avatar:t.contact.avatar},null)]}}),t.isMessage?Object(n["i"])("div",{class:"contact-content"},[Object(n["i"])("div",{class:"contact-info"},[Object(n["i"])("div",{class:"contact-nickname"},[t.contact.nickname]),Object(n["z"])(Object(n["i"])("div",{class:"contact-lastmsg-time"},[t.contact.lastMessageTime&&F(t.contact.lastMessageTime)]),[[n["x"],t.isMessage]])]),Object(n["z"])(Object(n["i"])("div",{class:"contact-action"},[Object(n["i"])("div",{class:"contact-content-inner"},[Object(n["z"])(Object(n["i"])("i",{class:"free-icon-error"},null),[[n["x"],"error"===t.contact.lastMessageStatus]]),Object(n["i"])("div",{class:"contact-lastmsg"},[t.contact.lastMessage])]),Object(n["i"])("div",{class:"contact-ban"},null)]),[[n["x"],t.isMessage]])]):Object(n["i"])("div",{class:"contact--nickname"},[t.contact.nickname])])}}}),jt=(a("7c7f"),A(ht)),Ot={unread:_(0)},yt=Object(n["j"])({name:"free-badge",props:Ot,setup:function(t,e){var a=e.slots;return function(){return Object(n["i"])("div",{class:"free-badge"},[a.default&&a.default(),Object(n["z"])(Object(n["i"])("div",{class:"free-badge-dot"},[t.unread>99?"99+":t.unread]),[[n["x"],!!t.unread]])])}}}),xt=(a("327d"),A(yt)),wt={width:C(300),title:I("Basic Modal"),header:T(!0),footer:T(!0),okText:I("确定"),cancelText:I("取消"),mask:T(!0),maskClosable:T(!0),show:T(!1)},Mt=Object(n["j"])({name:"free-dialog",props:wt,emits:["update:show","ok","cancel"],setup:function(t,e){var a=e.emit,r=e.slots,c=Object(n["l"])("freeIM"),i=c.width,o=c.height,d=function(){a("update:show",!1),a("cancel")},s=function(){t.maskClosable&&a("update:show",!1)},f=function(t){a("ok",t)};return function(){return Object(n["z"])(Object(n["i"])("div",{class:"free-dialog",style:"width:".concat(i,"px;height:").concat(o,"px;")},[Object(n["i"])("div",{class:"free-dialog-mask",onClick:s},null),Object(n["i"])("div",{class:"free-dialog-content",style:{width:"".concat(t.width,"px")}},[Object(n["z"])(Object(n["i"])("div",{class:"free-dialog-header"},[Object(n["i"])("div",{class:"free-dialog-header__title"},[t.title]),Object(n["i"])("i",{class:"free-icon-close",onClick:d},null)]),[[n["x"],t.header]]),Object(n["i"])("div",{class:"free-dialog-body"},[r.default?r.default():""]),Object(n["z"])(Object(n["i"])("div",{class:"free-dialog-footer"},[Object(n["i"])(Object(n["v"])("free-button"),{size:"mini",onClick:d},{default:function(){return[t.cancelText]}}),Object(n["i"])(Object(n["v"])("free-button"),{type:"primary",size:"mini",style:"margin-left: 10px;",onClick:f},{default:function(){return[t.okText]}})]),[[n["x"],t.footer]])])]),[[n["x"],t.show]])}}}),kt=(a("2dd8"),A(Mt)),_t={data:E(),contactId:_(""),isEnd:T(!1),loading:T(!0),messageName:T(!1),timeRange:C(1)},Ct=Object(n["j"])({name:"free-messages",props:_t,setup:function(t,e){var a=e.emit,r=Object(n["u"])(),c=Object(n["l"])("userInfo"),i=Object(n["u"])(!0),o=function(e){if(!t.isEnd){i.value=!0;var n=e.target;0===n.scrollTop&&(console.log("触发加载..."),a("load"))}};function d(){Object(n["o"])((function(){r.value&&(r.value.scrollTop=r.value.scrollHeight)}))}var s=Object(n["b"])((function(){return!t.isEnd&&t.loading})),f=Object(n["b"])((function(){return 1e3*t.timeRange*60}));return Z({scrollToBottom:d}),function(){return Object(n["i"])("div",{ref:r,class:"free-message",onScroll:o},[Object(n["i"])("div",{class:"free-messages-loading"},[Object(n["z"])(Object(n["i"])("i",{class:"free-icon-loading"},null),[[n["x"],s.value]]),Object(n["z"])(Object(n["i"])("div",{class:"free-messages-load_text"},[Object(n["h"])("暂无更多消息")]),[[n["x"],t.isEnd]])]),t.data.map((function(e,a){var r=[],i=t.data[a-1];i&&e.time-i.time>f.value&&r.push(Object(n["i"])(Object(n["v"])("free-message-event"),{message:{id:"__time__",type:"event",content:q(e.time)}},null));"free-message-".concat(e.type);var o={message:e,reverse:c.id===e.from.id,messageName:t.messageName};return r.push("image"===e.type?Object(n["i"])(Object(n["v"])("free-message-image"),o,null):"file"===e.type?Object(n["i"])(Object(n["v"])("free-message-file"),o,null):"event"===e.type?Object(n["i"])(Object(n["v"])("free-message-event"),{message:{id:"__time__",type:"event",content:q(e.time)}},null):Object(n["i"])(Object(n["v"])("free-message-text"),o,null)),r}))])}}}),It=Object(n["j"])({name:"free-message-image",setup:function(t,e){var a=e.attrs,r={content:function(t){return Object(n["i"])("img",{src:t.content},null)}};return function(){return Object(n["i"])(Object(n["v"])("free-message-template"),Object(n["n"])({class:"free-message-image"},a),r)}}}),Tt=Object(n["j"])({name:"free-message-file",setup:function(t,e){var a=e.attrs,r=function(t){var e=t.content;window.open(e,"_blank")};return function(){return Object(n["i"])(Object(n["v"])("free-message-template"),Object(n["n"])({class:"free-message-file"},a),{content:function(t){return[Object(n["i"])("div",{class:"free-message-file__content",onClick:function(e){return r(t)}},[Object(n["i"])("div",{class:"free-message-file__inner"},[Object(n["i"])("p",{class:"free-message-file__name"},[t.fileName]),Object(n["i"])("p",{class:"free-message-file__size"},[t.fileSize&&U(t.fileSize)])]),Object(n["i"])("i",{class:"free-icon-file"},null)])]}})}}}),St=Object(n["j"])({name:"free-message-text",setup:function(t,e){var a=e.attrs;return function(){return Object(n["i"])(Object(n["v"])("free-message-template"),a,{content:function(t){return Object(n["i"])("span",{innerHTML:t.content},null)}})}}}),Et={message:S()},Lt=Object(n["j"])({props:Et,name:"free-message-event",setup:function(t){return function(){return Object(n["i"])("div",{class:"free-message-content free-message-event"},[Object(n["i"])("span",{class:"free-message-event__content"},[t.message.content])])}}}),zt={message:S(),reverse:T(!1),messageName:T(!1)},Pt=Object(n["j"])({name:"free-message-template",props:zt,emits:["message-click"],setup:function(t,e){var a=e.slots,r=(e.emit,Object(n["l"])("freeIM")),c=function(e,a){r.$emit("message-click",e,a,t.message,r)},i=function(t){c(t,"status")},o=function(t){c(t,"content")},d=function(t){c(t,"avatar")};return function(){var e;return Object(n["i"])("div",{class:"free-message-content free-message-".concat(t.reverse?"right":"left"),key:t.message.id},[Object(n["i"])(Object(n["v"])("free-avatar"),{onClick:d,avatar:t.message.from.avatar,size:36},null),Object(n["i"])("div",{class:"free-message-info"},[Object(n["z"])(Object(n["i"])("div",{class:"free-message-username"},[t.message.from.nickname]),[[n["x"],t.messageName]]),Object(n["i"])("div",{class:"free-message-content__wrap"},[Object(n["i"])("div",{class:"free-message-content__text",onClick:o},[null===(e=a["content"])||void 0===e?void 0:e.call(a,t.message)]),Object(n["i"])("div",{style:"padding-left: 10px;"},null),Object(n["i"])("div",{class:"free-message-content__status"},[Object(n["z"])(Object(n["i"])("i",{class:"free-icon-loading"},null),[[n["x"],"uploading"===t.message.status]]),Object(n["z"])(Object(n["i"])("i",{class:"free-icon-error",onClick:i},null),[[n["x"],"error"===t.message.status]])])])])])}}}),Dt=(a("31a0"),A(Ct)),Nt=A(It),At=A(Tt),Ft=A(St),Bt=A(Lt),Ut=A(Pt),qt=[{name:"1f600",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f600.png"},{name:"1f62c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f62c.png"},{name:"1f601",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f601.png"},{name:"1f602",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f602.png"},{name:"1f923",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f923.png"},{name:"1f973",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f973.png"},{name:"1f603",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f603.png"},{name:"1f604",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f604.png"},{name:"1f605",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f605.png"},{name:"1f606",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f606.png"},{name:"1f607",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f607.png"},{name:"1f609",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f609.png"},{name:"1f60a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60a.png"},{name:"1f642",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f642.png"},{name:"1f643",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f643.png"},{name:"1263a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/263a.png"},{name:"1f60b",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60b.png"},{name:"1f60c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60c.png"},{name:"1f60d",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60d.png"},{name:"1f970",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f970.png"},{name:"1f618",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f618.png"},{name:"1f617",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f617.png"},{name:"1f619",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f619.png"},{name:"1f61a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61a.png"},{name:"1f61c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61c.png"},{name:"1f92a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92a.png"},{name:"1f928",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f928.png"},{name:"1f9d0",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f9d0.png"},{name:"1f61d",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61d.png"},{name:"1f61b",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61b.png"},{name:"1f911",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f911.png"},{name:"1f913",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f913.png"},{name:"1f60e",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60e.png"},{name:"1f929",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f929.png"},{name:"1f921",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f921.png"},{name:"1f920",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f920.png"},{name:"1f917",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f917.png"},{name:"1f60f",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60f.png"},{name:"1f636",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f636.png"},{name:"1f610",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f610.png"},{name:"1f611",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f611.png"},{name:"1f612",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f612.png"},{name:"1f644",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f644.png"},{name:"1f914",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f914.png"},{name:"1f925",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f925.png"},{name:"1f92d",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92d.png"},{name:"1f92b",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92b.png"},{name:"1f92c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92c.png"},{name:"1f92f",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92f.png"},{name:"1f633",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f633.png"},{name:"1f61e",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61e.png"},{name:"1f61f",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61f.png"},{name:"1f620",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f620.png"},{name:"1f621",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f621.png"}],Gt=function(t,e){document.execCommand(t,!1,e)},Yt={contact:S()},Rt=Object(n["j"])({name:"free-editor",props:Yt,emits:["send","upload"],setup:function(t,e){var a=e.emit,r=Object(n["u"])(),c=Object(n["u"])(""),i=function(t){"Enter"!==t.code||t.ctrlKey||t.shiftKey||(t.preventDefault(),Gt("insertLineBreak")),"Enter"===t.code&&t.ctrlKey&&o()};function o(){var t;console.log("发送"),a("send",null===(t=r.value)||void 0===t?void 0:t.innerHTML),d()}function d(){r.value.innerHTML=""}var s,f=Object(n["u"])(),u=Object(n["u"])(),l=function(t){var e=t.target.files;e&&e.length&&(u.value=e,console.log(e),p.value=!0)},v=function(){f.value&&(f.value.value="")},m=function(){var t;null===(t=f.value)||void 0===t||t.click()},p=Object(n["u"])(!1),b=qt,g=Object(n["u"])(!1),h=function(){p.value=!1,g.value=!0},j=function(t){return t.map((function(t){return Object(n["i"])("img",{src:t.src,title:t.title,class:"free-editor-emoji__item",onClick:function(){return k(t)}},null)}))},O=window.getSelection();function y(){w()}function x(){w()}function w(){s=null===O||void 0===O?void 0:O.getRangeAt(0)}function M(){var t;null===(t=r.value)||void 0===t||t.focus(),s&&(null===O||void 0===O||O.removeAllRanges(),null===O||void 0===O||O.addRange(s))}var k=function(t){g.value=!1,M(),Gt("insertHTML",'<img emoji-name="'.concat(t.name,'" src="').concat(t.src,'" width="20px" height="20px"></img>')),w()},_=function(){u.value&&u.value.length&&(Array.from(u.value).forEach((function(t){a("upload",t)})),c.value&&a("send",c.value),p.value=!1,v())},C=function(){v()};return function(){return Object(n["i"])("div",{class:"free-editor"},[Object(n["i"])(Object(n["v"])("free-dialog"),{show:g.value,"onUpdate:show":function(t){return g.value=t},title:"表情",width:465,footer:!1},{default:function(){return[Object(n["i"])("div",{class:"free-editor-files"},[Object(n["i"])("div",{class:"free-editor-emoji__content"},[j(b)])])]}}),Object(n["i"])(Object(n["v"])("free-dialog"),{show:p.value,"onUpdate:show":function(t){return p.value=t},width:260,header:!1,onOk:_,onCancel:C},{default:function(){return[Object(n["i"])("div",{class:"free-editor-files"},[Object(n["i"])("div",{class:"free-editor-files__title"},[Object(n["h"])("发送给：")]),Object(n["i"])("div",{class:"free-editor-files__info"},[Object(n["i"])(Object(n["v"])("free-avatar"),{avatar:t.contact.avatar},null),Object(n["i"])("div",{class:"free-editor-files__nickname"},[t.contact.nickname])]),Object(n["i"])("div",{class:"free-editor-files__content"},[Object(n["i"])("div",{class:"free-editor-files__list"},[u.value?Array.from(u.value).map((function(t){return Object(n["i"])("div",{class:"free-editor-files__item"},[Object(n["i"])("i",{class:"free-icon-files"},null),Object(n["i"])("div",{class:"free-editor-files__right"},[Object(n["i"])("div",{class:"free-editor-filename"},[t.name]),Object(n["i"])("div",{class:"free-editor-filesize"},[U(t.size)])])])})):[]]),Object(n["i"])("div",{class:"free-editor-files__footer"},[Object(n["z"])(Object(n["i"])("input",{"onUpdate:modelValue":function(t){return c.value=t},class:"free-editor-files__input",type:"text",placeholder:"给朋友留言"},null),[[n["w"],c.value]])])])])]}}),Object(n["i"])("input",{type:"file",ref:f,multiple:!0,style:"display: none;",onChange:l},null),Object(n["i"])("div",{class:"free-editor-tool"},[Object(n["i"])("div",{class:"free-editor-tool__item",onClick:h},[Object(n["i"])("i",{class:"free-icon-emoji"},null)]),Object(n["i"])("div",{class:"free-editor-tool__item"},[Object(n["i"])("i",{class:"free-icon-file",onClick:m},null)])]),Object(n["i"])("div",{class:"free-editor-content"},[Object(n["i"])("div",{ref:r,class:"free-editor-textarea",contenteditable:!0,spellcheck:"false",onKeydown:i,onKeyup:y,onClick:x},null)]),Object(n["i"])("div",{class:"free-editor-footer"},[Object(n["i"])("div",{class:"free-editor-footer__inner"},[Object(n["i"])("div",{class:"free-editor-footer__text"},[Object(n["h"])("ctrl + enter 快捷发送消息")]),Object(n["i"])(Object(n["v"])("free-button"),{onClick:o},{default:function(){return[Object(n["h"])("发送")]}})])])])}}}),Ht=(a("72cb"),A(Rt)),Kt=(a("2e03"),a("9faf"),[ft,vt,jt,bt,Dt,Ht,xt,kt,Nt,Ut,At,Ft,Bt]),Zt=function(t){Kt.map((function(e){return t.component(e.name,e)}))},Jt={install:Zt},$t=Object(n["c"])(M);$t.use(Jt),$t.mount("#app")},a9a5:function(t,e,a){}});
//# sourceMappingURL=index.3f3e547e.js.map